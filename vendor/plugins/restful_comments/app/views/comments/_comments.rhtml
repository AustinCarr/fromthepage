<hr>
<h2><%= comment_type %>s</h1>
<%
	user = if defined? current_user then current_user else nil end
	extension = commentable.class.comments_extension
%>

<% if extension.can_comment?( commentable, nil, user ) %>
<%   if comment_type == 'review' %>
	(<%=link_to_function 'Request Review', 'restfulComments.showReviewForm( 0 )' %>)
<%   else %>
	(<%=link_to_function 'Annotate', 'restfulComments.showForm( 0 )' %>)
<%   end %>
<% end %>

<% if comment_type == 'review' %>
<div id="review_form_0">
	<%=render :partial => 'comments/review_form_new', :locals => { :commentable => commentable } %>	
</div>
<% else %>
<div id="comment_form_0">
	<%=render :partial => 'comments/form_new', :locals => { :commentable => commentable } %>	
</div>
<% end %>

<%odd = 1%>
<% Comment.for_each(commentable.comments, comment_type)do |comment|%>
<% if comment_type == 'review' %>
	<%=render({ :partial => 'comments/review', 
	            :locals => { :comment => comment, 
	                         :odd => odd,
	                         :comment_type => comment_type }
	          })%>
<% else %>
	<%=render({ :partial => 'comments/comment', 
	            :locals => { :comment => comment, 
	                         :odd => odd,
	                         :comment_type => comment_type }
	          })%>
<% end %>

	<%odd = 3 - odd%>
<%end%>


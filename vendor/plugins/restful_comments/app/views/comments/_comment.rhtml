<%
	user = if defined? current_user then current_user else nil end
	extension = comment.commentable.class.comments_extension
%>
<div id="comment_<%=comment.id%>" class="comment comment-<%= odd %>" style="margin-left:<%= comment.depth * 50 %>px">
	<a name="comment_<%=comment.id%>"></a>
	
	<div class="header">
		<%if defined? User%>
			<%= comment.user.display_name unless comment.user.nil? %>
		<%end%>
		<h3><%= comment.title %></h3>
	</div>
				
	<div class="text">
		<%= comment.to_html %>
	</div>	
		
	<div class="links">
		<%if extension.can_comment?( comment.commentable, comment, user ) %>

	<%   if comment.comment_type == 'review' %>
				(<%=link_to_function 'Reply', 'restfulComments.showReviewForm( ' + comment.id.to_s + ')'  %>)
	<%   else %>
				(<%=link_to_function 'Reply', 'restfulComments.showForm( ' + comment.id.to_s + ')'  %>)
	<%   end %>
		<%end%>
		<%if extension.can_remove?( comment.commentable, comment, user ) %>
      (<a href="#" onclick="if (confirm('Are you sure?')) { new Ajax.Request('/comments/<%=comment.id.to_s%>', {asynchronous:true, evalScripts:true, method:'delete', onComplete:  Element.remove('comment_<%=comment.id.to_s%>')}); }; return false;">Delete</a>)
		<%end%>
	</div>
	
		
	<div id="comment_form_<%= comment.id %>"></div>	
</div>